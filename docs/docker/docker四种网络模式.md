# docker 四种网络模式
 >区别：  
 > 1、host模式的容器和宿主机共用一个“Network Namespace”；  
 > 2、Container模式创建的容器会与指定的容器共享IP和端口范围；  
 > 3、None模式关闭了容器的网络功能；  
 > 4、Bridge默认模式为每个容器分配设置IP。
 
### 1.Host模式
 >+ 如果启动容器的时候使用host模式，那么这个容器将不会获得一个独立的Network Namespace，而是和宿主机共用一个Network Namespace，容器将不会虚拟出自己的网卡，配置自己的IP等，而是使用宿主机的IP和端口  
 >+ 使用host模式的容器可以直接使用宿主机的IP地址与外界通信，容器内部的服务端口也可以使用宿主机的端口，不需要进行NAT，host最大的优势就是网络性能比较好，但是docker host上已经使用的端口就不能再用了，网络的隔离性不好
 
### 2.Container模式
 >+ 创建的容器不会创建自己的网卡，配置自己的IP，而是和一个指定的容器共享IP、端口范围  
 >+ 这个模式指定新创建的容器和已经存在的一个容器共享一个 Network Namespace，而不是和宿主机共享。同样，两个容器除了网络方面，其他的如文件系统、进程列表等还是隔离的。两个容器的进程可以通过 lo 网卡设备通信

### 3.None模式
 >+ 该模式关闭了容器的网络功能
 >+ 使用none模式，Docker容器拥有自己的Network Namespace，但是，并不为Docker容器进行任何网络配置。也就是说，这个Docker容器没有网卡、IP、路由等信息。需要我们自己为Docker容器添加网卡、配置IP等  
 >+ 这种网络模式下容器只有lo回环网络，没有其他网卡。none模式可以在容器创建时通过–network=none来指定。这种类型的网络没有办法联网，封闭的网络能很好的保证容器的安全性  
 >+ 单机没网，安全性很高，可以安全的储存数据，不会被攻击
 
### 4.Bridge模式（默认）

 >+ 此模式会为每一个容器分配、设置IP等，并将容器连接到一个docker0虚拟网桥，通过docker0网桥以及iptables nat表配置与宿主之间的关联  
 >+ 当Docker进程启动时，会在主机上创建一个名为docker0的虚拟网桥，此主机上启动的Docker容器会连接到这个虚拟网桥上。虚拟网桥的工作方式和物理交换机类似，这样主机上的所有容器就通过交换机连在了一个二层网络中  
 >+ 从docker0子网中分配一个IP给容器使用，并设置docker0的IP地址为容器的默认网关。在主机上创建一对虚拟网卡veth pair设备，Docker将veth pair设备的一端放在新创建的容器中，并命名为eth0（容器的网卡），另一端放在主机中，以vethxxx这样类似的名字命名，并将这个网络设备加入到docker0网桥中。可以通过brctl show命令查看  
 >+ bridge模式是docker的默认网络模式，不写–net参数，就是bridge模式。使用docker run -p时，docker实际是在iptables做了DNAT规则，实现端口转发功能。可以使用iptables -t nat -vnL查看


## 综上
>+ Host : 与 宿主机共享网络名称空间/网络协议栈，IP 共享、端口范围共享.

>+ Container: 多个容器之间共享一个networknamespaces，多个容器公用一个IP和端口范围

>+ None : 自 闭空间，无网卡，无需网络连接

>+ Bridge: 桥接， 默认模式，在不指定网络模式的情况下创建容器，默认使用此模式, 通过Veth对连接容器与docker0网桥，网桥分配IP给容器,同时docker0作为“局域网”内容器的网关，最后和宿主机网卡进行通讯, 同时，通过IPtables规则将容器IP/port映射出去，用于与宿主机网卡交互
